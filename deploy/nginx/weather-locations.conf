# Nginx configuration for weather daemon
# Include this in your main nginx server block:
# include /etc/nginx/sites-available/weather-locations.conf;
#
# IMPORTANT: Create a symlink to the cache directory:
# ln -s /opt/weather-daemon/cache /var/www/yoursite.com/html/weather

# Serve static weather JSON files
location /weather/ {
    alias /var/www/html/weather/;

    # Only allow GET requests
    limit_except GET {
        deny all;
    }

    # Set content type
    default_type application/json;

    # CORS headers (adjust origins as needed)
    add_header Access-Control-Allow-Origin *;
    add_header Access-Control-Allow-Methods "GET, OPTIONS";
    add_header Access-Control-Allow-Headers "Content-Type";

    # Security headers
    add_header X-Content-Type-Options nosniff;
    add_header X-Frame-Options DENY;
    add_header X-XSS-Protection "1; mode=block";

    # Cache for 60 seconds (weather updates hourly)
    add_header Cache-Control "public, max-age=60";

    # Enable gzip compression
    gzip on;
    gzip_types application/json;
}
